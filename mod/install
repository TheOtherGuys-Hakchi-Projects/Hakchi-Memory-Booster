 # Swingflip - HakchiResources.com https://discord.gg/8gygsrw
 
    ok=1

    # Reset
    Color_Off="\e[33;0m"       # Text Reset
    
    # Regular Colors
    Black="\e[33;0;30m"        # Black
    Red="\e[33;0;31m"          # Red
    Green="\e[33;0;32m"        # Green
    Yellow="\e[33;0;33m"       # Yellow
    Blue="\e[33;0;34m"         # Blue
    Purple="\e[33;0;35m"       # Purple
    Cyan="\e[33;0;36m"         # Cyan
    White="\e[33;0;37m"        # White

#Duping is ugly but I am echoing out the STDOUT in the console and the HDMI output...

echo "***************************************"
echo "*** Hakchi Memory Booster Installer ***"
echo "***************************************"
echo "  By Swingflip / HakchiResources.com   "

echo -e "${Green}***************************************" > /dev/tty0
echo -e "${Green}*** Hakchi Memory Booster Installer ***" > /dev/tty0
echo -e "${Green}***************************************" > /dev/tty0
echo -e "${Yellow}  By Swingflip / HakchiResources.com   " > /dev/tty0

transfer_default #Transfer the preinit script (maybe it should be an init service... Dunno yet.)

echo "Running media read write test on USB/SD..." 
echo -e "${White}Running media read write test on USB/SD..." > /dev/tty0

touch "$writeTest" || ok=0
rm "$writeTest" || ok=0

if [ "$ok" == "0" ]; then
    echo "[FAILED] Couldn't write to USB/SD. Make sure you have an USB/SD mounted and try again!"
    echo -e "${White}[${Red}FAILED${White}] Couldn't write to USB/SD. Make sure you have an USB/SD mounted and try again!" > /dev/tty0
    sleep 3 #Let the fail soak in for a bit.
    return 66
fi

echo "Creating and intialising 256MB swap file on USB/SD root (256MB.swap)..."
echo -e "${White}Creating and intialising 256MB swap file on USB/SD root (256MB.swap)..." > /dev/tty0

#This is where the magic happens...
fallocate -l 256MB /media/256MB.swap &> /dev/tty0 #Pls no xtreme 1GB swap
dd if=/dev/zero of=/media/256MB.swap bs=1M count=256 &> /dev/tty0
chmod 600 /media/256MB.swap &> /dev/tty0
mkswap /media/256MB.swap &> /dev/tty0

if [ ! -f "/media/256MB.swap" ]; then
    echo "[FAILED] Couldn't create and initialise the swap file! Check the output on the TV and try again!"
    echo -e "${White}[${Red}FAILED${White}] Couldn't create and initialise the swap file! Check the output on the TV and try again!" > /dev/tty0
    sleep 3 #Let the fail soak in for a bit.
    return 99
fi

#Must of worked...
echo "***************************************"
echo "*** Memory Booster Install Success! ***"
echo "***************************************"
echo "       Rebooting in 3 seconds...       "

echo -e "${Green}***************************************" > /dev/tty0
echo -e "${Green}*** Memory Booster Install Success! ***" > /dev/tty0
echo -e "${Green}***************************************" > /dev/tty0
echo -e "${White}       Rebooting in 3 seconds...       " > /dev/tty0

sleep 3
return 1